### Tomcat性能优化

1. Tomcat性能优化

   * ### 减配调优

     * Servlet
     * Valve

   场景一：假设当前为REST应用（微服务）

   分析：它不需要静态资源，Tomcat容器静态和动态

   * 静态处理：`DefaultServlet`

   * 动态：`JspServlet` ==> 编译并且执行JSP页面

   SpringWebMVC 应用Servlet：`DispatcherServlet` ==> Tomcat处理静态资源的Servlet

   优化方案：在conf/web.xml中移除对应的Servlet

   * 移除welcome-file-list

   如果程序是REST-JSON Content-Type：application/json

   * 移除Session设置

   对于微服务/REST应用，不需要Session，因为不需要状态

   SpringSercurity OAuth2.0 、JWT

   Session通过jsessionId进行用户跟踪，HTTP无状态，需要一个ID与当前用户会话联系。Spring Session中jsessionId作为Redis，实现多个机器登陆，用户会话不丢失。

   * 移除Valve

     移除Server.xml中的`Valve`配置

   场景二：需要JSP的情况

   分析：`JspSevlet`，了解`JspServlet` 处理原理

   Servlet和Filter 实现类必须包含默认构造器。反射的方式进行实例化

   * JspServlet相关的优化`ServletConfig`参数

     a. 需要编译

     ​	compiler

     ​	modificationTestInterval

     b.不需要编译

     ​	development设置false

     `development==false`，jsp要如何编译

     * Ant Task 执行JSP编译
     * Maven插件：codehaus

     JSP->翻译.jsp或者.jspx文件成.java->编译.class 文件

   - ### 配置调整

     - 关闭自动部署

       `autoDeploy="false"`

     - 线程池数量

       ```xml
       <Executor name="tomcatThreadPool" namePrefix="catalina-exec-"
               maxThreads="150" minSpareThreads="4"/>
       		
           <Connector executor="tomcatThreadPool"
                      port="8080" protocol="HTTP/1.1"
                      connectionTimeout="20000"
                      redirectPort="8443" />
       ```

   - ### 预编译优化

     - jsp

2. 程序调优

   

3. JVM参数调优

